policies:
  - name: cosmosdb-analytical-store-not-used
    resource: azure.cosmosdb
    filters:
      - type: value
        key: properties.capabilities[*].name
        op: in
        value:
          - "EnableStorageAnalytics"
      - type: metric
        metric: TotalRequestUnits
        op: lt
        threshold: 100   # Very low RU usage for analytical queries
        timeframe: 24

#Checks for analytical store capability.
#Monitors if itâ€™s underutilized (very low request units).
#Notifies so that you can disable or reconfigure the analytical store.
